// modernizr-2.0.6.min.js
;window.Modernizr=function(a,b,c){function I(){e.input=function(a){for(var b=0,c=a.length;b<c;b++)t[a[b]]=a[b]in l;return t}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)l.setAttribute("type",f=a[d]),e=l.type!=="text",e&&(l.value=m,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&l.style.WebkitAppearance!==c?(g.appendChild(l),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(l,null).WebkitAppearance!=="textfield"&&l.offsetHeight!==0,g.removeChild(l)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=l.checkValidity&&l.checkValidity()===!1:/^color$/.test(f)?(g.appendChild(l),g.offsetWidth,e=l.value!=m,g.removeChild(l)):e=l.value!=m)),s[a[d]]=!!e;return s}("search tel url email datetime date month week time datetime-local number range color".split(" "))}function G(a,b){var c=a.charAt(0).toUpperCase()+a.substr(1),d=(a+" "+p.join(c+" ")+c).split(" ");return F(d,b)}function F(a,b){for(var d in a)if(k[a[d]]!==c)return b=="pfx"?a[d]:!0;return!1}function E(a,b){return!!~(""+a).indexOf(b)}function D(a,b){return typeof a===b}function C(a,b){return B(o.join(a+";")+(b||""))}function B(a){k.cssText=a}var d="2.0.6",e={},f=!0,g=b.documentElement,h=b.head||b.getElementsByTagName("head")[0],i="modernizr",j=b.createElement(i),k=j.style,l=b.createElement("input"),m=":)",n=Object.prototype.toString,o=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),p="Webkit Moz O ms Khtml".split(" "),q={svg:"http://www.w3.org/2000/svg"},r={},s={},t={},u=[],v=function(a,c,d,e){var f,h,j,k=b.createElement("div");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:i+(d+1),k.appendChild(j);f=["­","<style>",a,"</style>"].join(""),k.id=i,k.innerHTML+=f,g.appendChild(k),h=c(k,a),k.parentNode.removeChild(k);return!!h},w=function(b){if(a.matchMedia)return matchMedia(b).matches;var c;v("@media "+b+" { #"+i+" { position: absolute; } }",function(b){c=(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle).position=="absolute"});return c},x=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=D(e[d],"function"),D(e[d],c)||(e[d]=c),e.removeAttribute(d))),e=null;return f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),y,z={}.hasOwnProperty,A;!D(z,c)&&!D(z.call,c)?A=function(a,b){return z.call(a,b)}:A=function(a,b){return b in a&&D(a.constructor.prototype[b],c)};var H=function(c,d){var f=c.join(""),g=d.length;v(f,function(c,d){var f=b.styleSheets[b.styleSheets.length-1],h=f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"",i=c.childNodes,j={};while(g--)j[i[g].id]=i[g];e.touch="ontouchstart"in a||j.touch.offsetTop===9,e.csstransforms3d=j.csstransforms3d.offsetLeft===9,e.generatedcontent=j.generatedcontent.offsetHeight>=1,e.fontface=/src/i.test(h)&&h.indexOf(d.split(" ")[0])===0},g,d)}(['@font-face {font-family:"font";src:url("https://")}',["@media (",o.join("touch-enabled),("),i,")","{#touch{top:9px;position:absolute}}"].join(""),["@media (",o.join("transform-3d),("),i,")","{#csstransforms3d{left:9px;position:absolute}}"].join(""),['#generatedcontent:after{content:"',m,'";visibility:hidden}'].join("")],["fontface","touch","csstransforms3d","generatedcontent"]);r.flexbox=function(){function c(a,b,c,d){a.style.cssText=o.join(b+":"+c+";")+(d||"")}function a(a,b,c,d){b+=":",a.style.cssText=(b+o.join(c+";"+b)).slice(0,-b.length)+(d||"")}var d=b.createElement("div"),e=b.createElement("div");a(d,"display","box","width:42px;padding:0;"),c(e,"box-flex","1","width:10px;"),d.appendChild(e),g.appendChild(d);var f=e.offsetWidth===42;d.removeChild(e),g.removeChild(d);return f},r.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},r.canvastext=function(){return!!e.canvas&&!!D(b.createElement("canvas").getContext("2d").fillText,"function")},r.webgl=function(){return!!a.WebGLRenderingContext},r.touch=function(){return e.touch},r.geolocation=function(){return!!navigator.geolocation},r.postmessage=function(){return!!a.postMessage},r.websqldatabase=function(){var b=!!a.openDatabase;return b},r.indexedDB=function(){for(var b=-1,c=p.length;++b<c;)if(a[p[b].toLowerCase()+"IndexedDB"])return!0;return!!a.indexedDB},r.hashchange=function(){return x("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},r.history=function(){return!!a.history&&!!history.pushState},r.draganddrop=function(){return x("dragstart")&&x("drop")},r.websockets=function(){for(var b=-1,c=p.length;++b<c;)if(a[p[b]+"WebSocket"])return!0;return"WebSocket"in a},r.rgba=function(){B("background-color:rgba(150,255,150,.5)");return E(k.backgroundColor,"rgba")},r.hsla=function(){B("background-color:hsla(120,40%,100%,.5)");return E(k.backgroundColor,"rgba")||E(k.backgroundColor,"hsla")},r.multiplebgs=function(){B("background:url(https://),url(https://),red url(https://)");return/(url\s*\(.*?){3}/.test(k.background)},r.backgroundsize=function(){return G("backgroundSize")},r.borderimage=function(){return G("borderImage")},r.borderradius=function(){return G("borderRadius")},r.boxshadow=function(){return G("boxShadow")},r.textshadow=function(){return b.createElement("div").style.textShadow===""},r.opacity=function(){C("opacity:.55");return/^0.55$/.test(k.opacity)},r.cssanimations=function(){return G("animationName")},r.csscolumns=function(){return G("columnCount")},r.cssgradients=function(){var a="background-image:",b="gradient(linear,left top,right bottom,from(#9f9),to(white));",c="linear-gradient(left top,#9f9, white);";B((a+o.join(b+a)+o.join(c+a)).slice(0,-a.length));return E(k.backgroundImage,"gradient")},r.cssreflections=function(){return G("boxReflect")},r.csstransforms=function(){return!!F(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])},r.csstransforms3d=function(){var a=!!F(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);a&&"webkitPerspective"in g.style&&(a=e.csstransforms3d);return a},r.csstransitions=function(){return G("transitionProperty")},r.fontface=function(){return e.fontface},r.generatedcontent=function(){return e.generatedcontent},r.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType){c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"');var d='video/mp4; codecs="avc1.42E01E';c.h264=a.canPlayType(d+'"')||a.canPlayType(d+', mp4a.40.2"'),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"')}}catch(e){}return c},r.audio=function(){var a=b.createElement("audio"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"'),c.mp3=a.canPlayType("audio/mpeg;"),c.wav=a.canPlayType('audio/wav; codecs="1"'),c.m4a=a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")}catch(d){}return c},r.localstorage=function(){try{return!!localStorage.getItem}catch(a){return!1}},r.sessionstorage=function(){try{return!!sessionStorage.getItem}catch(a){return!1}},r.webworkers=function(){return!!a.Worker},r.applicationcache=function(){return!!a.applicationCache},r.svg=function(){return!!b.createElementNS&&!!b.createElementNS(q.svg,"svg").createSVGRect},r.inlinesvg=function(){var a=b.createElement("div");a.innerHTML="<svg/>";return(a.firstChild&&a.firstChild.namespaceURI)==q.svg},r.smil=function(){return!!b.createElementNS&&/SVG/.test(n.call(b.createElementNS(q.svg,"animate")))},r.svgclippaths=function(){return!!b.createElementNS&&/SVG/.test(n.call(b.createElementNS(q.svg,"clipPath")))};for(var J in r)A(r,J)&&(y=J.toLowerCase(),e[y]=r[J](),u.push((e[y]?"":"no-")+y));e.input||I(),B(""),j=l=null,a.attachEvent&&function(){var a=b.createElement("div");a.innerHTML="<elem></elem>";return a.childNodes.length!==1}()&&function(a,b){function s(a){var b=-1;while(++b<g)a.createElement(f[b])}a.iepp=a.iepp||{};var d=a.iepp,e=d.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",f=e.split("|"),g=f.length,h=new RegExp("(^|\\s)("+e+")","gi"),i=new RegExp("<(/*)("+e+")","gi"),j=/^\s*[\{\}]\s*$/,k=new RegExp("(^|[^\\n]*?\\s)("+e+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),l=b.createDocumentFragment(),m=b.documentElement,n=m.firstChild,o=b.createElement("body"),p=b.createElement("style"),q=/print|all/,r;d.getCSS=function(a,b){if(a+""===c)return"";var e=-1,f=a.length,g,h=[];while(++e<f){g=a[e];if(g.disabled)continue;b=g.media||b,q.test(b)&&h.push(d.getCSS(g.imports,b),g.cssText),b="all"}return h.join("")},d.parseCSS=function(a){var b=[],c;while((c=k.exec(a))!=null)b.push(((j.exec(c[1])?"\n":c[1])+c[2]+c[3]).replace(h,"$1.iepp_$2")+c[4]);return b.join("\n")},d.writeHTML=function(){var a=-1;r=r||b.body;while(++a<g){var c=b.getElementsByTagName(f[a]),d=c.length,e=-1;while(++e<d)c[e].className.indexOf("iepp_")<0&&(c[e].className+=" iepp_"+f[a])}l.appendChild(r),m.appendChild(o),o.className=r.className,o.id=r.id,o.innerHTML=r.innerHTML.replace(i,"<$1font")},d._beforePrint=function(){p.styleSheet.cssText=d.parseCSS(d.getCSS(b.styleSheets,"all")),d.writeHTML()},d.restoreHTML=function(){o.innerHTML="",m.removeChild(o),m.appendChild(r)},d._afterPrint=function(){d.restoreHTML(),p.styleSheet.cssText=""},s(b),s(l);d.disablePP||(n.insertBefore(p,n.firstChild),p.media="print",p.className="iepp-printshim",a.attachEvent("onbeforeprint",d._beforePrint),a.attachEvent("onafterprint",d._afterPrint))}(a,b),e._version=d,e._prefixes=o,e._domPrefixes=p,e.mq=w,e.hasEvent=x,e.testProp=function(a){return F([a])},e.testAllProps=G,e.testStyles=v,g.className=g.className.replace(/\bno-js\b/,"")+(f?" js "+u.join(" "):"");return e}(this,this.document),function(a,b,c){function k(a){return!a||a=="loaded"||a=="complete"}function j(){var a=1,b=-1;while(p.length-++b)if(p[b].s&&!(a=p[b].r))break;a&&g()}function i(a){var c=b.createElement("script"),d;c.src=a.s,c.onreadystatechange=c.onload=function(){!d&&k(c.readyState)&&(d=1,j(),c.onload=c.onreadystatechange=null)},m(function(){d||(d=1,j())},H.errorTimeout),a.e?c.onload():n.parentNode.insertBefore(c,n)}function h(a){var c=b.createElement("link"),d;c.href=a.s,c.rel="stylesheet",c.type="text/css";if(!a.e&&(w||r)){var e=function(a){m(function(){if(!d)try{a.sheet.cssRules.length?(d=1,j()):e(a)}catch(b){b.code==1e3||b.message=="security"||b.message=="denied"?(d=1,m(function(){j()},0)):e(a)}},0)};e(c)}else c.onload=function(){d||(d=1,m(function(){j()},0))},a.e&&c.onload();m(function(){d||(d=1,j())},H.errorTimeout),!a.e&&n.parentNode.insertBefore(c,n)}function g(){var a=p.shift();q=1,a?a.t?m(function(){a.t=="c"?h(a):i(a)},0):(a(),j()):q=0}function f(a,c,d,e,f,h){function i(){!o&&k(l.readyState)&&(r.r=o=1,!q&&j(),l.onload=l.onreadystatechange=null,m(function(){u.removeChild(l)},0))}var l=b.createElement(a),o=0,r={t:d,s:c,e:h};l.src=l.data=c,!s&&(l.style.display="none"),l.width=l.height="0",a!="object"&&(l.type=d),l.onload=l.onreadystatechange=i,a=="img"?l.onerror=i:a=="script"&&(l.onerror=function(){r.e=r.r=1,g()}),p.splice(e,0,r),u.insertBefore(l,s?null:n),m(function(){o||(u.removeChild(l),r.r=r.e=o=1,j())},H.errorTimeout)}function e(a,b,c){var d=b=="c"?z:y;q=0,b=b||"j",C(a)?f(d,a,b,this.i++,l,c):(p.splice(this.i++,0,a),p.length==1&&g());return this}function d(){var a=H;a.loader={load:e,i:0};return a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=r&&!s,u=s?l:n.parentNode,v=a.opera&&o.call(a.opera)=="[object Opera]",w="webkitAppearance"in l.style,x=w&&"async"in b.createElement("script"),y=r?"object":v||x?"img":"script",z=w?"img":y,A=Array.isArray||function(a){return o.call(a)=="[object Array]"},B=function(a){return Object(a)===a},C=function(a){return typeof a=="string"},D=function(a){return o.call(a)=="[object Function]"},E=[],F={},G,H;H=function(a){function f(a){var b=a.split("!"),c=E.length,d=b.pop(),e=b.length,f={url:d,origUrl:d,prefixes:b},g,h;for(h=0;h<e;h++)g=F[b[h]],g&&(f=g(f));for(h=0;h<c;h++)f=E[h](f);return f}function e(a,b,e,g,h){var i=f(a),j=i.autoCallback;if(!i.bypass){b&&(b=D(b)?b:b[a]||b[g]||b[a.split("/").pop().split("?")[0]]);if(i.instead)return i.instead(a,b,e,g,h);e.load(i.url,i.forceCSS||!i.forceJS&&/css$/.test(i.url)?"c":c,i.noexec),(D(b)||D(j))&&e.load(function(){d(),b&&b(i.origUrl,h,g),j&&j(i.origUrl,h,g)})}}function b(a,b){function c(a){if(C(a))e(a,h,b,0,d);else if(B(a))for(i in a)a.hasOwnProperty(i)&&e(a[i],h,b,i,d)}var d=!!a.test,f=d?a.yep:a.nope,g=a.load||a.both,h=a.callback,i;c(f),c(g),a.complete&&b.load(a.complete)}var g,h,i=this.yepnope.loader;if(C(a))e(a,0,i,0);else if(A(a))for(g=0;g<a.length;g++)h=a[g],C(h)?e(h,0,i,0):A(h)?H(h):B(h)&&b(h,i);else B(a)&&b(a,i)},H.addPrefix=function(a,b){F[a]=b},H.addFilter=function(a){E.push(a)},H.errorTimeout=1e4,b.readyState==null&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",G=function(){b.removeEventListener("DOMContentLoaded",G,0),b.readyState="complete"},0)),a.yepnope=d()}(this,this.document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};
// jquery-ui-1.8.18.min.js
(function(a,b){function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;if(!b.href||!g||f.nodeName.toLowerCase()!=="map")return!1;h=a("img[usemap=#"+g+"]")[0];return!!h&&d(h)}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.18",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function h(b,c,d,f){a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return c}var e=d==="Width"?["Left","Right"]:["Top","Bottom"],f=d.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){if(c===b)return g["inner"+d].call(this);return this.each(function(){a(this).css(f,h(this,c)+"px")})},a.fn["outer"+d]=function(b,c){if(typeof b!="number")return g["outer"+d].call(this,b);return this.each(function(){a(this).css(f,h(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight,a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!!d&&!!a.element[0].parentNode)for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;if(b[d]>0)return!0;b[d]=1,e=b[d]>0,b[d]=0;return e},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}}))})(jQuery);(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}});return d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e;if(f&&e.charAt(0)==="_")return h;f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b){h=f;return!1}}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))});return h}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}this._setOptions(e);return this},_setOptions:function(b){var c=this;a.each(b,function(a,b){c._setOption(a,b)});return this},_setOption:function(a,b){this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e,f,g=this.options[b];d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent;if(f)for(e in f)e in c||(c[e]=f[e]);this.element.trigger(c,d);return!(a.isFunction(g)&&g.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(jQuery);(function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent")){a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation();return!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=this._mouseStart(b)!==!1;if(!this._mouseStarted){b.preventDefault();return!0}}!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0;return!0}},_mouseMove:function(b){if(a.browser.msie&&!(document.documentMode>=9)&&!b.button)return this._mouseUp(b);if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(jQuery);(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){a.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var b=this.items.length-1;b>=0;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this,g=a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==f){e=a(this);return!1}});a.data(b.target,d.widgetName+"-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var h=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(h=!0)});if(!h)return!1}this.currentItem=e,this._removeCurrentsFromItems();return!0},_mouseStart:function(b,c,d){var e=this.options,f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),e.containment&&this._setContainment(),e.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",e.cursor)),e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity)),e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(var g=this.containers.length-1;g>=0;g--)this.containers[g]._trigger("activate",b,f._uiHash(this));a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b);return!0},_mouseDrag:function(b){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),d!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],g=f.item[0],h=this._intersectsWithPointer(f);if(!h)continue;if(g!=this.currentItem[0]&&this.placeholder[h==1?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],g):!0)){this.direction=h==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(f))this._rearrange(b,f);else break;this._trigger("change",b,this._uiHash());break}}this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(b,c){if(!!b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0,a(this.helper).animate({left:e.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"=");return d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")});return d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l=d+j>h&&d+j<i&&b+k>f&&b+k<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?l:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();if(!e)return!1;return this.floating?g&&g=="right"||f=="down"?2:1:f&&(f=="down"?2:1)},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&d||f=="left"&&!d:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){this._refreshItems(a),this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=this,d=[],e=[],f=this._connectWith();if(f&&b)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&e.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=e.length-1;g>=0;g--)e[g][0].each(function(){d.push(this)});return a(d)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.widgetName+"-item)");for(var b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,d=this,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}}for(var g=e.length-1;g>=0;g--){var k=e[g][1],l=e[g][0];for(var i=0,m=l.length;i<m;i++){var n=a(l[i]);n.data(this.widgetName+"-item",k),c.push({item:n,instance:k,width:0,height:0,left:0,top:0})}}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var d=this.items[c];if(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])continue;var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());var f=e.offset();d.left=f.left,d.top=f.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var c=this.containers.length-1;c>=0;c--){var f=this.containers[c].element.offset();this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight()}return this},_createPlaceholder:function(b){var c=b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];e||(b.style.visibility="hidden");return b},update:function(a,b){if(!e||!!d.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){var c=null,d=null;for(var e=this.containers.length-1;e>=0;e--){if(a.ui.contains(this.currentItem[0],this.containers[e].element[0]))continue;if(this._intersectsWith(this.containers[e].containerCache)){if(c&&a.ui.contains(this.containers[e].element[0],c.element[0]))continue;c=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0)}if(!!c)if(this.containers.length===1)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){var f=1e4,g=null,h=this.positionAbs[this.containers[d].floating?"left":"top"];for(var i=this.items.length-1;i>=0;i--){if(!a.ui.contains(this.containers[d].element[0],this.items[i].item[0]))continue;var j=this.items[i][this.containers[d].floating?"left":"top"];Math.abs(j-h)<f&&(f=Math.abs(j-h),g=this.items[i])}if(!g&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[d],g?this._rearrange(b,g,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;d.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(d[0].style.width==""||c.forceHelperSize)&&d.width(this.currentItem.width()),(d[0].style.height==""||c.forceHelperSize)&&d.height(this.currentItem.height());return d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],d=a(b.containment).offset(),e=a(c).css("overflow")!="hidden";this.containment=[d.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,d.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,d.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;if(this.originalPosition){this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top));if(c.grid){var h=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1];g=this.containment?h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3]?h-this.offset.click.top<this.containment[1]?h+c.grid[1]:h-c.grid[1]:h:h;var i=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0];f=this.containment?i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2]?i-this.offset.click.left<this.containment[0]?i+c.grid[0]:i-c.grid[0]:i:i}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var d=[],e=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(var f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(var f=this.containers.length-1;f>=0;f--)c||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.18"})})(jQuery);
// helper.js
(function(document){window.MBP=window.MBP||{};MBP.viewportmeta=document.querySelector&&document.querySelector('meta[name="viewport"]');MBP.ua=navigator.userAgent;MBP.scaleFix=function(){if(MBP.viewportmeta&&/iPhone|iPad|iPod/.test(MBP.ua)&&!/Opera Mini/.test(MBP.ua)){MBP.viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0";document.addEventListener("gesturestart",MBP.gestureStart,false);}};MBP.gestureStart=function(){MBP.viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6";};MBP.BODY_SCROLL_TOP=false;MBP.getScrollTop=function(){var win=window,doc=document;return win.pageYOffset||doc.compatMode==="CSS1Compat"&&doc.documentElement.scrollTop||doc.body.scrollTop||0;};MBP.hideUrlBar=function(){var win=window;if(!location.hash&&MBP.BODY_SCROLL_TOP!==false){win.scrollTo(0,MBP.BODY_SCROLL_TOP===1?0:1);}};MBP.hideUrlBarOnLoad=function(){var win=window,doc=win.document;if(!location.hash&&win.addEventListener){window.scrollTo(0,1);MBP.BODY_SCROLL_TOP=1;bodycheck=setInterval(function(){if(doc.body){clearInterval(bodycheck);MBP.BODY_SCROLL_TOP=MBP.getScrollTop();MBP.hideUrlBar();}},15);win.addEventListener("load",function(){setTimeout(function(){if(MBP.getScrollTop()<20){MBP.hideUrlBar();}},0);});}};MBP.fastButton=function(element,handler){this.element=element;this.handler=handler;addEvt(element,"touchstart",this,false);addEvt(element,"click",this,false);};MBP.fastButton.prototype.handleEvent=function(event){event=event||window.event;switch(event.type){case'touchstart':this.onTouchStart(event);break;case'touchmove':this.onTouchMove(event);break;case'touchend':this.onClick(event);break;case'click':this.onClick(event);break;}};MBP.fastButton.prototype.onTouchStart=function(event){event.stopPropagation();this.element.addEventListener('touchend',this,false);document.body.addEventListener('touchmove',this,false);this.startX=event.touches[0].clientX;this.startY=event.touches[0].clientY;this.element.style.backgroundColor="rgba(0,0,0,.7)";};MBP.fastButton.prototype.onTouchMove=function(event){if(Math.abs(event.touches[0].clientX-this.startX)>10||Math.abs(event.touches[0].clientY-this.startY)>10){this.reset();}};MBP.fastButton.prototype.onClick=function(event){event=event||window.event;if(event.stopPropagation){event.stopPropagation();}
this.reset();this.handler(event);if(event.type=='touchend'){MBP.preventGhostClick(this.startX,this.startY);}
this.element.style.backgroundColor="";};MBP.fastButton.prototype.reset=function(){rmEvt(this.element,"touchend",this,false);rmEvt(document.body,"touchmove",this,false);this.element.style.backgroundColor="";};MBP.preventGhostClick=function(x,y){MBP.coords.push(x,y);window.setTimeout(function(){MBP.coords.splice(0,2);},2500);};MBP.ghostClickHandler=function(event){if(!MBP.hadTouchEvent&&'ontouchstart'in window){event.stopPropagation();event.preventDefault();return;}
for(var i=0,len=MBP.coords.length;i<len;i+=2){var x=MBP.coords[i];var y=MBP.coords[i+1];if(Math.abs(event.clientX-x)<25&&Math.abs(event.clientY-y)<25){event.stopPropagation();event.preventDefault();}}};if(document.addEventListener){document.addEventListener('click',MBP.ghostClickHandler,true);}
addEvt(document.documentElement,'touchstart',function(){MBP.hadTouchEvent=true;},false);MBP.coords=[];function addEvt(el,evt,fn,bubble){if("addEventListener"in el){try{el.addEventListener(evt,fn,bubble);}catch(e){if(typeof fn=="object"&&fn.handleEvent){el.addEventListener(evt,function(e){fn.handleEvent.call(fn,e);},bubble);}else{throw e;}}}else if("attachEvent"in el){if(typeof fn=="object"&&fn.handleEvent){el.attachEvent("on"+evt,function(){fn.handleEvent.call(fn);});}else{el.attachEvent("on"+evt,fn);}}}
function rmEvt(el,evt,fn,bubble){if("removeEventListener"in el){try{el.removeEventListener(evt,fn,bubble);}catch(e){if(typeof fn=="object"&&fn.handleEvent){el.removeEventListener(evt,function(e){fn.handleEvent.call(fn,e);},bubble);}else{throw e;}}}else if("detachEvent"in el){if(typeof fn=="object"&&fn.handleEvent){el.detachEvent("on"+evt,function(){fn.handleEvent.call(fn);});}else{el.detachEvent("on"+evt,fn);}}}
MBP.splash=function(){var filename=navigator.platform==='iPad'?'h/':'l/';document.write('<link rel="apple-touch-startup-image" href="/img/'+filename+'splash.png" />');};MBP.autogrow=function(element,lh){function handler(e){var newHeight=this.scrollHeight,currentHeight=this.clientHeight;if(newHeight>currentHeight){this.style.height=newHeight+3*textLineHeight+"px";}}
var setLineHeight=(lh)?lh:12,textLineHeight=element.currentStyle?element.currentStyle.lineHeight:getComputedStyle(element,null).lineHeight;textLineHeight=(textLineHeight.indexOf("px")==-1)?setLineHeight:parseInt(textLineHeight,10);element.style.overflow="hidden";element.addEventListener?element.addEventListener('keyup',handler,false):element.attachEvent('onkeyup',handler);};MBP.enableActive=function(){document.addEventListener("touchstart",function(){},false);};MBP.viewportMeta=$('meta[name="viewport"]');MBP.preventZoom=function(){$('input, select, textarea').bind('focus blur',function(event){MBP.viewportMeta.attr('content','width=device-width,initial-scale=1,maximum-scale='+(event.type=='blur'?10:1));});};})(document);
// trivialaQuizzer.js
if(!$||!($.toJSON||Object.toJSON||window.JSON)){throw new error("jQuery needed for trivialaQuizzer");}
var trivialaQuizzer={init:function(params){var setParams=settings.setParams(params);if(!setParams){showError("Invalid quiz params");return;}
debug.enabled=false;debug.log("---------- Quizzer Started ----------");viewManager.reset();clock.reset();gameData.reset();showPreloader();},reset:function(){clock.reset();gameData.reset();}};var settings={APP_VERSION:20110116,APP_VERSION_MIN:20110116,APP_VERSION_MAX:20110116,APP_ID:"com.triviala.quizzer",GAME_STATUS_AWAITING:0,GAME_STATUS_STARTING:1,GAME_STATUS_PLAYING:2,GAME_STATUS_ENDED:3,quizId:0,appUrl:"http://m.triviala.com/",gserverUrl:"http://m.triviala.com/g/ugcquizzes_mobile",setParams:function(params){if(params&&params.qid&&params.qid!=null&&params.qid>0){settings.quizId=params.qid;return true;}else{return false;}}};var debug={enabled:false,log:function(msg){if(this.enabled&&window.console&&window.console.log){msg="["+getTime()+"] "+msg;window.console.log(msg);}
function getTime(){var d=new Date();return d.getHours()+':'+d.getMinutes()+':'+d.getSeconds();}}};var viewManager={currentView:'#game-preloader',reset:function(){var views=['#game-preloader','#game-intro','#game-main','#game-over','#game-error'];for(var i in views){$(views[i]).hide();}},show:function(view){if(this.currentView!=''){$(this.currentView).hide();}
this.currentView=view;$(this.currentView).fadeIn('slow');},hide:function(view){this.currentView='';$(view).hide();}};var gserverApi={s:'',connect:function(onConnect,onFail){$.ajax({url:settings.gserverUrl,type:'POST',cache:false,dataType:'json',data:{_cmd:'connect'},success:function(data){if(data.s&&data.s!=''){gserverApi.s=data.s;}else{onFail();return;}
if(data.message=='OK'){onConnect();}else{onFail();return;}},error:function(j,t,e){onFail();}});},getQuiz:function(quizId,onSuccess){$.ajax({url:settings.gserverUrl,type:'POST',cache:false,dataType:'json',data:{_cmd:'getQuiz',s:gserverApi.s,quizId:quizId,gameMode:1},success:function(data){if(data._cmd=='error'){showError(data.message);return;}
onSuccess(data);},error:function(j,t,e){showError('Failed to get quiz.');}});},startGame:function(onSuccess){$.ajax({url:settings.gserverUrl,type:'POST',cache:false,dataType:'json',data:{_cmd:'startGame',s:gserverApi.s},success:function(data){if(data._cmd=='error'){showError(data.message);return;}
onSuccess(data);},error:function(j,t,e){showError('Failed to start game.');}});},endGame:function(quizId,answersData,onSuccess){$.ajax({url:settings.gserverUrl,type:'POST',cache:false,dataType:'json',data:{_cmd:'endGame',s:gserverApi.s,quizId:quizId,a:answersData},success:function(data){if(data._cmd=='error'){showError(data.message);return;}
onSuccess(data);},error:function(j,t,e){showError('Failed to save score.');}});}};var gameData={gameMode:"",quizId:0,points:0,quizData:{},showCorrectAnswer:true,questions:[],playerData:{},answersData:{},parseAndSetData:function(data){var quizData={};quizData.bubbleText=data.bubbleText;quizData.category=data.category;quizData.creatorAvatar=data.creatorAvatar;quizData.creatorQuizzesNo=data.creatorQuizzesNo;quizData.creatorUsername=data.creatorUsername;quizData.description=String(data.description);quizData.nofq=data.nofq;quizData.plays=data.plays;quizData.quizId=data.quizId;quizData.ratingScore=data.ratingScore;quizData.ratingVotes=data.ratingVotes;quizData.timerType=data.timerType;quizData.timerLength=data.timerLength;quizData.title=String(data.title);quizData.themeUrl=data.themeUrl;quizData.photo=data.photo;quizData.url=data.url;quizData.pointsPerAnswer=data.pointsPerAnswer;this.quizData=quizData;var playerData={};playerData.avatar=data.user.avatar;playerData.isGuest=data.user.isGuest;playerData.username=data.user.username;this.playerData=playerData;this.showCorrectAnswer=true;this.questions=data.questions;},reset:function(){this.gameMode="";this.quizId=0;this.points=0;this.quizData={};this.showCorrectAnswer=true;this.questions=[];this.playerData={};this.answersData={};}};function showPreloader(){$('#preloader-txt').text("loading game assets...");viewManager.show("#game-preloader");debug.log("showPreloader");gserverApi.connect(function(){debug.log("connect OK");gserverApi.getQuiz(settings.quizId,function(data){gameData.parseAndSetData(data);showIntro();});},function(){showError("Could not connect to server");});}
function showIntro(){$('#giUsername').text(gameData.quizData.creatorUsername);$('#giAvatar').attr('src',gameData.quizData.creatorAvatar);$('#giTitle').text(gameData.quizData.title);$('#giDescr').text(gameData.quizData.description);$('#giNofq').text(gameData.quizData.nofq);$('#giRating').text(gameData.quizData.ratingScore+'/5');$('#giBtnStart').bind('vclick',function(e){e.preventDefault();gserverApi.startGame(showMain);});viewManager.show("#game-intro");}
function showMain(){var qMC3A;var qOrder;var qMatch;var qMC4A;var qTapitout;var qIndex=0;var QUESTION_TYPE_MC3A=1;var QUESTION_TYPE_ORDER=2;var QUESTION_TYPE_MATCH=3;var QUESTION_TYPE_MC4A=4;var QUESTION_TYPE_TAPINOUT=5;function init(){qMC3A=questionMC3A();qOrder=questionOrder();qMatch=questionMatch();qMC4A=questionMC4A();qTapitout=questionTapitout();clock.init(gameData.quizData.timerType,gameData.quizData.timerLength);$('#header h2').text(gameData.quizData.title);$('#gmAvatar').attr('src',gameData.quizData.creatorAvatar);$('#gmUsername').text(gameData.quizData.creatorUsername);$('#gmNofq').text('1/'+gameData.quizData.nofq);viewManager.show("#game-main");getQuestion();}
function getQuestion(){if(qIndex==gameData.quizData.nofq){clock.stop_all();showGameOver();return;}
var q={};if(gameData.questions[qIndex]){q=gameData.questions[qIndex];}else{showError('question not found');return;}
$('#gmNofq').text((qIndex+1)+'/'+gameData.quizData.nofq);if(qIndex==1){}else if((qIndex%3)==1){}
if(q.type<1){showError("Invalid question type");return;}
if(q.type==QUESTION_TYPE_MC3A){qMC3A.draw(q,nextQuestion);}else if(q.type==QUESTION_TYPE_ORDER){qOrder.draw(q,nextQuestion);}else if(q.type==QUESTION_TYPE_MATCH){qMatch.draw(q,nextQuestion);}else if(q.type==QUESTION_TYPE_MC4A){qMC4A.draw(q,nextQuestion);}else if(q.type==QUESTION_TYPE_TAPINOUT){qTapitout.draw(q,nextQuestion);}}
function nextQuestion(){qIndex++;getQuestion();}
function hide(){}
init();}
var questionMC3A=function(){var instance={};var onComplete;var q;var selectedAnswer;instance.draw=function(_q,_onComplete){q=_q;onComplete=_onComplete;$('#qmQTxt').text(q.q);if(q.photo_url){$('#qmqImg').attr('src',q.photo_url);$('#qmqImgBox').show();}else{$('#qmqImgBox').hide();}
$('#qmqMc3Btn1').text(q.a1);$('#qmqMc3Btn2').text(q.a2);$('#qmqMc3Btn3').text(q.a3);$('#qmqMc3Btn1').bind('vclick',function(){selectAnswer(1);});$('#qmqMc3Btn2').bind('vclick',function(){selectAnswer(2);});$('#qmqMc3Btn3').bind('vclick',function(){selectAnswer(3);});$('#qmqMc3 ul li').each(function(){$(this).find('.circle').removeClass('circleR circleW circleS');});$('#qmqMc3').show();$('#qmQTxt').fadeIn('slow');$('#qmqMc3 ul li').each(function(){$(this).fadeIn('slow');});clock.start(onTimeout);};var selectAnswer=function(answerId){debug.log('selectAnswer'+answerId);selectedAnswer=answerId;gameData.answersData[q.qid]=answerId;$('#qmqMc3Btn1').unbind();$('#qmqMc3Btn2').unbind();$('#qmqMc3Btn3').unbind();clock.stop();if(answerId>0){$('#qmqMc3Btn'+answerId).parent().find('.circle').addClass('circleS');}
window.setTimeout(showAnswer,1000);};var showAnswer=function(){var correctAnswer=q.ac;if(selectedAnswer>0&&selectedAnswer==correctAnswer){gameData.points+=gameData.quizData.pointsPerAnswer;}
if(gameData.showCorrectAnswer){$('#qmqMc3Btn'+correctAnswer).parent().find('.circle').addClass('circleR');if(selectedAnswer>0){if(selectedAnswer!=correctAnswer){$('#qmqMc3Btn'+selectedAnswer).parent().find('.circle').addClass('circleW');}}
$('#gmScore').text(gameData.points);}
window.setTimeout(hideAnswer,2000);};var hideAnswer=function(){$('#qmQTxt').fadeOut('slow',function(){$(this).text('');});$('#qmqMc3 ul li:eq(0)').fadeOut('slow',function(){$('#qmqMc3Btn1').text('');});$('#qmqMc3 ul li:eq(1)').fadeOut('slow',function(){$('#qmqMc3Btn2').text('');});$('#qmqMc3 ul li:eq(2)').fadeOut('slow',function(){$('#qmqMc3Btn3').text('');$('#qmqMc3').hide();onComplete();});};var onTimeout=function(){selectAnswer(0);};return instance;};var questionOrder=function(){var instance={};var onComplete;var q;var selectedAnswer;instance.draw=function(_q,_onComplete){q=_q;onComplete=_onComplete;$('#qmQTxt').text(q.q);if(q.photo_url){$('#qmqImg').attr('src',q.photo_url);$('#qmqImgBox').show();}else{$('#qmqImgBox').hide();}
$('#qmqO1').text(q.a1);$('#qmqO2').text(q.a2);$('#qmqO3').text(q.a3);$('#qmqO4').text(q.a4);$('#qmqO ul').sortable();$('#qmqO ul').disableSelection();$('#qmqO ul li').each(function(){$(this).find('.circle').removeClass('circleR circleW circleS');});$('#qmqO').show();$('#qmQTxt').fadeIn('slow');$('#qmqO ul li').each(function(){$(this).fadeIn('slow');});$('#qmqOBtn').fadeIn('slow');$('#qmqOBtn').bind('vclick',function(){var sa=[];$('#qmqO ul li a').each(function(){sa.push($(this).attr('id').replace('qmqO',''));});selectAnswer(sa.join(','));});clock.start(onTimeout);};var selectAnswer=function(answerString){selectedAnswer=answerString;gameData.answersData[q.qid]=answerString;$('#qmqOBtn').unbind();$('#qmqO ul').sortable("destroy");$('#qmqOBtn').fadeOut('fast');clock.stop();window.setTimeout(showAnswer,1000);};var showAnswer=function(){debug.log('showAnswer');var correctAnswer=q.ac;if(selectedAnswer==correctAnswer){gameData.points+=gameData.quizData.pointsPerAnswer;}
if(gameData.showCorrectAnswer){if(selectedAnswer!=''){var selectedAnswerArray=selectedAnswer.split(',');var correctAnswerArray=correctAnswer.split(',');for(var i=0,n=correctAnswerArray.length;i<n;i++){if(selectedAnswerArray[i]==correctAnswerArray[i]){$('#qmqO ul li:eq('+i+')').find('.circle').addClass('circleR');}else{$('#qmqO ul li:eq('+i+')').find('.circle').addClass('circleW');}}}
$('#gmScore').text(gameData.points);}
window.setTimeout(hideAnswer,2000);};var hideAnswer=function(){$('#qmQTxt').fadeOut('slow',function(){$(this).text('');});$('#qmqO ul li:eq(0)').fadeOut('slow',function(){$('#qmqO1').text('');});$('#qmqO ul li:eq(1)').fadeOut('slow',function(){$('#qmqO2').text('');});$('#qmqO ul li:eq(2)').fadeOut('slow',function(){$('#qmqO3').text('');});$('#qmqO ul li:eq(3)').fadeOut('slow',function(){$('#qmqO4').text('');$('#qmqO').hide();onComplete();});};var onTimeout=function(){selectAnswer('');};return instance;};var questionMatch=function(){var instance={};var onComplete;var q;var selectedAnswer;instance.draw=function(_q,_onComplete){q=_q;onComplete=_onComplete;$('#qmQTxt').text(q.q);if(q.photo_url){$('#qmqImg').attr('src',q.photo_url);$('#qmqImgBox').show();}else{$('#qmqImgBox').hide();}
$('#qmqML1').text(q.al1);$('#qmqML2').text(q.al2);$('#qmqML3').text(q.al3);$('#qmqML4').text(q.al4);$('#qmqMR1').text(q.ar1);$('#qmqMR2').text(q.ar2);$('#qmqMR3').text(q.ar3);$('#qmqMR4').text(q.ar4);$('#qmqMR').sortable();$('#qmqMR').disableSelection();$('#qmqML li').each(function(){$(this).find('.circle').removeClass('circleR circleW circleS');});$('#qmqMR li').each(function(){$(this).find('.circle').removeClass('circleR circleW circleS');});$('#qmqM').show();$('#qmQTxt').fadeIn('slow');$('#qmqML li').each(function(){$(this).fadeIn('slow');});$('#qmqMR li').each(function(){$(this).fadeIn('slow');});$('#qmqMBtn').fadeIn('slow');$('#qmqMBtn').bind('vclick',function(){var sa=[];$('#qmqMR li a').each(function(){sa.push($(this).attr('id').replace('qmqMR',''));});selectAnswer(sa.join(','));});clock.start(onTimeout);};var selectAnswer=function(answerString){selectedAnswer=answerString;gameData.answersData[q.qid]=answerString;$('#qmqMBtn').unbind();$('#qmqMR').sortable("destroy");$('#qmqMBtn').fadeOut('fast');clock.stop();window.setTimeout(showAnswer,1000);};var showAnswer=function(){debug.log('showAnswer');var correctAnswer=q.ac;if(selectedAnswer==correctAnswer){gameData.points+=gameData.quizData.pointsPerAnswer;}
if(gameData.showCorrectAnswer){if(selectedAnswer!=''){var selectedAnswerArray=selectedAnswer.split(',');var correctAnswerArray=correctAnswer.split(',');for(var i=0,n=correctAnswerArray.length;i<n;i++){if(selectedAnswerArray[i]==correctAnswerArray[i]){$('#qmqMR li:eq('+i+')').find('.circle').addClass('circleR');}else{$('#qmqMR li:eq('+i+')').find('.circle').addClass('circleW');}}}
$('#gmScore').text(gameData.points);}
window.setTimeout(hideAnswer,2000);}
var hideAnswer=function(){$('#qmQTxt').fadeOut('slow',function(){$(this).text('');})
$('#qmqML li').each(function(){$(this).fadeOut('slow');$(this).text('');});$('#qmqMR li:eq(0)').fadeOut('slow',function(){$('#qmqMR1').text('');});$('#qmqMR li:eq(1)').fadeOut('slow',function(){$('#qmqMR2').text('');});$('#qmqMR li:eq(2)').fadeOut('slow',function(){$('#qmqMR3').text('');});$('#qmqMR li:eq(3)').fadeOut('slow',function(){$('#qmqMR4').text('');$('#qmqM').hide();onComplete();});}
var onTimeout=function(){selectAnswer('');}
return instance;};var questionMC4A=function(){var instance={};var onComplete;var q;var selectedAnswer;instance.draw=function(_q,_onComplete){q=_q;onComplete=_onComplete;$('#qmQTxt').text(q.q);if(q.photo_url){$('#qmqImg').attr('src',q.photo_url);$('#qmqImgBox').show();}else{$('#qmqImgBox').hide();}
$('#qmqMc4Btn1').text(q.a1);$('#qmqMc4Btn2').text(q.a2);$('#qmqMc4Btn3').text(q.a3);$('#qmqMc4Btn4').text(q.a4);$('#qmqMc4Btn1').bind('vclick',function(){selectAnswer(1);});$('#qmqMc4Btn2').bind('vclick',function(){selectAnswer(2);});$('#qmqMc4Btn3').bind('vclick',function(){selectAnswer(3);});$('#qmqMc4Btn4').bind('vclick',function(){selectAnswer(4);});$('#qmqMc4 ul li').each(function(){$(this).find('.circle').removeClass('circleR circleW circleS');});$('#qmqMc4').show();$('#qmQTxt').fadeIn('slow');$('#qmqMc4 ul li').each(function(){$(this).fadeIn('slow');});clock.start(onTimeout);};var selectAnswer=function(answerId){selectedAnswer=answerId;gameData.answersData[q.qid]=answerId;$('#qmqMc4Btn1').unbind();$('#qmqMc4Btn2').unbind();$('#qmqMc4Btn3').unbind();$('#qmqMc4Btn4').unbind();clock.stop();if(answerId>0){$('#qmqMc4Btn'+answerId).parent().find('.circle').addClass('circleS');}
window.setTimeout(showAnswer,1000);};var showAnswer=function(){debug.log('showAnswer');var correctAnswer=q.ac;if(selectedAnswer>0&&selectedAnswer==correctAnswer){gameData.points+=gameData.quizData.pointsPerAnswer;}
if(gameData.showCorrectAnswer){$('#qmqMc4Btn'+correctAnswer).parent().find('.circle').addClass('circleR');if(selectedAnswer>0){if(selectedAnswer!=correctAnswer){$('#qmqMc4Btn'+selectedAnswer).parent().find('.circle').addClass('circleW');}}
$('#gmScore').text(gameData.points);}
window.setTimeout(hideAnswer,2000);};var hideAnswer=function(){$('#qmQTxt').fadeOut('slow',function(){$(this).text('');})
$('#qmqMc4 ul li:eq(0)').fadeOut('slow',function(){$('#qmqMc4Btn1').text('');});$('#qmqMc4 ul li:eq(1)').fadeOut('slow',function(){$('#qmqMc4Btn2').text('');});$('#qmqMc4 ul li:eq(2)').fadeOut('slow',function(){$('#qmqMc4Btn3').text('');});$('#qmqMc4 ul li:eq(3)').fadeOut('slow',function(){$('#qmqMc4Btn4').text('');$('#qmqMc4').hide();onComplete();});};var onTimeout=function(){selectAnswer(0);};return instance;};var questionTapitout=function(){var instance={};var onComplete;var q;var selectedAnswer;instance.draw=function(_q,_onComplete){q=_q;onComplete=_onComplete;$('#qmQTxt').text(q.q);if(q.photo_url){$('#qmqImg').attr('src',q.photo_url);$('#qmqImgBox').show();}else{$('#qmqImgBox').hide();}
$('#qmqTioTxt').val('');$('#qmqTioTxtBox .circleInline').removeClass('circleInlineR circleInlineW').addClass('circleA');$('#qmqTioABox').hide();$('#qmqTioA').text('');$('#qmqTio').show();$('#qmQTxt').fadeIn('slow');$('#qmqTioTxtBox').fadeIn('slow',function(){$('#qmqTioBtn').fadeIn('slow');});$('#qmqTioBtn').bind('vclick',function(){var sa=$('#qmqTioTxt').val();if(sa!=''&&sa.length>0){selectAnswer(sa);}});clock.start(onTimeout);};var selectAnswer=function(answerString){selectedAnswer=$.trim(answerString).toLowerCase();gameData.answersData[q.qid]=answerString;$('#qmqTioBtn').unbind();$('#qmqTioBtn').fadeOut('fast');clock.stop();window.setTimeout(showAnswer,1000);};var showAnswer=function(){debug.log('showAnswer');var correctAnswer=$.trim(q.ac).toLowerCase();var isCorrectAnswer=false;if(selectedAnswer==correctAnswer){gameData.points+=gameData.quizData.pointsPerAnswer;isCorrectAnswer=true;}
if(gameData.showCorrectAnswer){if(isCorrectAnswer){$('#qmqTioTxtBox .circleInline').removeClass('circleA').addClass('circleInlineR');}else{$('#qmqTioTxtBox .circleInline').removeClass('circleA').addClass('circleInlineW');$('#qmqTioA').text(correctAnswer);$('#qmqTioABox').fadeIn('slow');}
$('#gmScore').text(gameData.points);}
window.setTimeout(hideAnswer,2000);};var hideAnswer=function(){$('#qmQTxt').fadeOut('slow',function(){$(this).text('');});$('#qmqTioABox').fadeOut('slow');$('#qmqTioTxtBox').fadeOut('slow',function(){$('#qmqTioTxt').val('');$('#qmqTio').hide();onComplete();});};var onTimeout=function(){selectAnswer('');};return instance;};var clock=(function(){var instance={};var $clock,timerType,timerLength,onTimeout,remainingTime=0,hasStarted=false,interval,TIMER_TYPE_PER_QUIZ=1,TIMER_TYPE_PER_QUESTION=2,TIMER_TYPE_NO_TIME=3;instance.init=function(_timerType,_timerLength){timerType=_timerType;timerLength=_timerLength;$clock=$('#gmClock');$clock.text('0');};instance.start=function(_onTimeout){onTimeout=_onTimeout;if(timerType==TIMER_TYPE_PER_QUIZ){if(hasStarted==false){hasStarted=true;doStart();}}else if(timerType==TIMER_TYPE_PER_QUESTION){doStart();}else if(timerType==TIMER_TYPE_NO_TIME){}};instance.stop=function(){if(timerType==TIMER_TYPE_PER_QUESTION){window.clearInterval(interval);}};instance.stop_all=function(){window.clearInterval(interval);interval=null;};instance.hide=function(){$clock.hide();};instance.reset=function(){instance.stop_all();if($clock){$clock.text('0');}};var doStart=function(){debug.log('dostart');debug.log(interval);remainingTime=timerLength;interval=window.setInterval(countdown,1000);};var countdown=function(){remainingTime=remainingTime-1;debug.log(remainingTime);if(remainingTime>=0){$clock.text(remainingTime);}else{window.clearInterval(interval);interval=null;timeOut();}};var timeOut=function(){onTimeout();if(timerType==TIMER_TYPE_PER_QUIZ){}};return instance;})();function showGameOver(){function init(){debug.log("showGameOver init");gserverApi.endGame(gameData.quizData.quizId,gameData.answersData,show);}
function show(data){var gameoverData={};gameoverData.points=data.points;gameoverData.crownsWon=data.crownsWon;gameoverData.rank=data.rank;gameoverData.isPlayerLoggedIn=data.isPlayerLoggedIn;$('#goScore').text(gameoverData.points);$('#goRank').text(gameoverData.rank);if(gameoverData.isPlayerLoggedIn){$('#logged').show();$('#notlogged').hide();}else{$('#logged').hide();$('#notlogged').show();}
viewManager.show("#game-over");}
init();};function showError(message){viewManager.show('#game-error');$('#pg-error-message').text(message);clock.reset();};
//trivialaMakeQuizzer.js
if(!$||!($.toJSON||Object.toJSON||window.JSON)){throw new error("jQuery needed for trivialaMakeQuizzer");}
var trivialaMakeQuizzer=function(){var instance={};var showSubcategory=function(){var subcatArray=[];subcatArray=subcatArrayGlobal?subcatArrayGlobal:[];var cat=$("#category");var catValue=0;if(catValueGlobal!=null&&catValueGlobal>0){catValue=catValueGlobal;}else if(cat.val()>0){catValue=cat.val();}
var subcat=$("#subcategory");var subcatValue=subcatValueGlobal!=null?subcatValueGlobal:0;if(subcatArray[catValue]==null){mysubcat=new Array();}else{mysubcat=subcatArray[catValue];}
subcat.empty();subcat.append('<option value="0" selected="selected">- Select -</option>');for(var i=0;i<mysubcat.length;i++){var j=i+1;subcat.append('<option value="'+mysubcat[i][0]+'">'+mysubcat[i][1]+'</option>');}
subcat.val(subcatValue);subcat.selectmenu('refresh',true);}
var showTimerLength=function(){var timerType=2;for(var i=1;i<4;i++){if($('#timer_type'+i).attr('checked')=='checked'){timerType=i;}}
if(timerType<0){return;}
var timer_length_text='';if(timerType==1){timer_length_text='40sec - 300sec';var nofq=$('#number_of_questions').val();if(nofq>0){timer_length_text=(nofq*10)+"sec - "+(nofq*60)+"sec";}}
var timerArray=["",timer_length_text,"15sec - 60sec"," "];if(timerArray[timerType]){$("#timer_length_text").text(timerArray[timerType]);}}
var showSection=function(sectionId){if(sectionId<1){return;}
for(var i=1;i<=5;i++){var quizTab=$("#mqTab"+i+" a");if(quizTab){if(sectionId==i){quizTab.addClass("ui-btn-active");}else{quizTab.removeClass("ui-btn-active ui-btn-up-c").addClass("ui-btn-up-d");}}}
for(var i=1;i<=5;i++){var section=$("#mqSection"+i);if(section){if(sectionId==i){section.show();}else{section.hide();}}}
if(sectionId==3){$("#mqImage").hide();}else{$("#mqImage").show();}
$("#mqInfoBox li").each(function(index){$(this).hide();if(sectionId==(index+1)){$(this).show();}});$("#question_type").val(sectionId);}
var updatePhoto=function(photoId,photoUrl){$("#photo_id").val(photoId);$("#quizPhoto").attr("src",photoUrl);$.fancybox.close();$("#removePhotoBox").show();}
var showPreloader=function(onComplete){$.fancybox({'padding':15,'autoScale':false,'transitionIn':'none','transitionOut':'none','overlayOpacity':0.4,'opacity':true,'hideOnOverlayClick':false,'showCloseButton':false,'href':'#preloader','onComplete':onComplete,'onClosed':function(){}});}
var hidePreloader=function(){$("#preloader").hide();}
instance.initStep1=function(){showSubcategory();showTimerLength();$('#category').bind('change',showSubcategory);for(var i=1;i<4;i++){var timerType=$('#timer_type'+i);timerType.bind("change",function(event,ui){showTimerLength();});}
$("#form_quiz1 #save").val(0);$("#mqSaveBtn1").bind("vclick",function(){$("#form_quiz1 #save").val(1);$("#form_quiz1").submit();});};instance.initStep2=function(){$('#form_quiz2 #category').bind('change',function(){var categoryId=$(this).val();document.location.href=$('#form_quiz2').attr('action')+'/cid/'+categoryId;});var themeId=$('#form_quiz2 #theme').val();var curImgSelected=$('#make-themes li #theme'+themeId+' img');curImgSelected.addClass('selected');$('#make-themes li a').bind('vclick',function(e){e.preventDefault();$('#form_quiz2 #theme').val($(this).attr('id').replace('theme',''));if(curImgSelected){curImgSelected.removeClass('selected');}
curImgSelected=$(this).find('img');curImgSelected.addClass('selected');});$('#form_quiz2 #save').val(0);$('#mqSaveBtn2').bind('vclick',function(){$('#form_quiz2 #save').val(1);$('#form_quiz2').submit();});};instance.initStep3=function(){var qt=$('#question_type').val();showSection(qt);for(var i=1;i<=5;i++){var quizTab=$("#mqTab"+i+" a");quizTab.i=i;if(quizTab){quizTab.bind('vclick',function(e){e.preventDefault();var id=$(this).parent().attr('id').replace('mqTab','')
showSection(id);});}}
$('#form_quiz3 #save').val(0);$('#mqSaveBtn3').bind('vclick',function(){$('#form_quiz3 #save').val(1);$('#form_quiz3').submit();});};return instance;}
// script.js
$('.btn-search').live('vclick',function(e){e.preventDefault();if($(".header-search").css("display")=="none"){$(".header-search").show();}else{$(".header-search").hide();}});$('#page-main').live('pagehide',function(event){var page=jQuery(event.target);page.remove();});$('#com').live('pageshow',function(event){if(document.location.hash.indexOf("/do/comment")!=-1){var height=$(document).height();$.mobile.silentScroll(height);}
$('.btnAddCommentMini').bind('vclick',function(e){e.preventDefault();$.mobile.silentScroll($(document).height());});});$('#make-step-1').live('pageshow',function(event){var tmq=new trivialaMakeQuizzer();tmq.initStep1();});$('#make-step-2').live('pageshow',function(event){var tmq=new trivialaMakeQuizzer();tmq.initStep2();});$('#make-step-3').live('pageshow',function(event){var tmq=new trivialaMakeQuizzer();tmq.initStep3();});$('#user-profile-avatar').live('pageshow',function(event){var avatarId=$('#form_avatar #avatar').val();var curImgSelected=$('#user-profile-avatars li #avatar_'+avatarId+' img');curImgSelected.addClass('selected');$('#user-profile-avatars li a').bind('vclick',function(e){e.preventDefault();$('#form_avatar #avatar').val($(this).attr('id').replace('avatar_',''));if(curImgSelected){curImgSelected.removeClass('selected');}
curImgSelected=$(this).find('img');curImgSelected.addClass('selected');});});$('#game').live('pageinit',function(event){var url=$('#game').attr('data-url');var quizId=url.substring(url.indexOf('id/')+3);trivialaQuizzer.init({qid:quizId});initTouch();});$('#game').live('pagehide',function(event){trivialaQuizzer.reset();});function initTouch(){/iPad|iPhone|iPod|Android/.test(navigator.userAgent)&&(function($){var proto=$.ui.mouse.prototype,_mouseInit=proto._mouseInit;$.extend(proto,{_mouseInit:function(){this.element.bind("touchstart."+this.widgetName,$.proxy(this,"_touchStart"));_mouseInit.apply(this,arguments);},_touchStart:function(event){if(event.originalEvent.targetTouches.length!=1){return false;}
this.element.bind("touchmove."+this.widgetName,$.proxy(this,"_touchMove")).bind("touchend."+this.widgetName,$.proxy(this,"_touchEnd"));this._modifyEvent(event);this._mouseDown(event);return false;},_touchMove:function(event){this._modifyEvent(event);this._mouseMove(event);},_touchEnd:function(event){this.element.unbind("touchmove."+this.widgetName).unbind("touchend."+this.widgetName);this._mouseUp(event);$(document).trigger('mouseup',event);},_modifyEvent:function(event){event.which=1;var target=event.originalEvent.targetTouches[0];event.pageX=target.clientX;event.pageY=target.clientY;}});})(jQuery);}